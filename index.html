<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Sport Lock</title>
<style>
body { font-family: Arial, sans-serif; text-align:center; margin:20px; }
.circle { width: 150px; height: 150px; border-radius: 50%; border: 10px solid #ccc; margin: 20px auto; position: relative; }
.progress { position: absolute; top:0; left:0; width:100%; height:100%; border-radius: 50%; clip: rect(0px, 150px, 150px, 75px); background: #4caf50; transform: rotate(0deg); transform-origin: center center; }
.inner { width: 120px; height: 120px; background:#fff; border-radius:50%; position:absolute; top:15px; left:15px; line-height:120px; font-size:24px; }
button { margin: 5px; padding: 10px 20px; font-size: 16px; }
#status { margin-top: 20px; font-size: 18px; }
label { display:block; margin:5px 0; }
input, select { padding:5px; width:120px; margin-right:5px; }
.sport-item { margin-bottom: 5px; }
</style>
</head>
<body>

<h1>Sport Lock</h1>

<h3>Objectifs JournÃ©e</h3>
<div id="daily-sports"></div>
<button onclick="addSport()">Ajouter un sport</button>
<button onclick="saveGoals()">Enregistrer objectifs</button>

<div class="circle">
  <div class="progress" id="progress"></div>
  <div class="inner" id="percent">0%</div>
</div>

<div id="status">Sport non terminÃ© ðŸ”’</div>
<button onclick="unlockTV()">DÃ©bloquer TV</button>
<button onclick="lockTV()">Bloquer TV</button>

<script>
/* Ajouter un sport */
function addSport(sportName='', distance=0){
  const container = document.getElementById('daily-sports');
  const div = document.createElement('div');
  div.className = 'sport-item';
  div.innerHTML = `
    <select class="sport">
      <option value="course" ${sportName==='course'?'selected':''}>Course Ã  pied</option>
      <option value="velo" ${sportName==='velo'?'selected':''}>VÃ©lo</option>
      <option value="marche" ${sportName==='marche'?'selected':''}>Marche</option>
      <option value="muscu" ${sportName==='muscu'?'selected':''}>Musculation</option>
    </select>
    <input type="number" class="distance" value="${distance}" placeholder="Distance km">
    <button onclick="removeSport(this)">Supprimer</button>
  `;
  container.appendChild(div);
}

/* Supprimer sport */
function removeSport(btn){ btn.parentElement.remove(); }

/* Enregistrer les objectifs */
function saveGoals(){
  const container = document.getElementById('daily-sports');
  const goals = [];
  container.querySelectorAll('.sport-item').forEach(div=>{
    const sport = div.querySelector('.sport').value;
    const distance = parseFloat(div.querySelector('.distance').value) || 0;
    goals.push({sport,distance});
  });
  localStorage.setItem('dailyGoals', JSON.stringify(goals));
  alert('Objectifs enregistrÃ©s !');
  updateProgress();
}

/* Calcul du pourcentage (test sans Strava) */
function updateProgress(){
  const goals = JSON.parse(localStorage.getItem('dailyGoals')) || [];
  const totalGoal = goals.reduce((sum,g)=>sum+g.distance,0);
  // Pour test, on simule les km rÃ©alisÃ©s = moitiÃ© de chaque objectif
  const totalDone = goals.reduce((sum,g)=>sum+g.distance*0.5,0); 
  const percent = totalGoal>0 ? Math.min(Math.round(totalDone/totalGoal*100),100) : 0;
  setProgress(percent);
}

/* Cercle */
function setProgress(percent){
  const deg = percent*3.6;
  document.getElementById('progress').style.transform=`rotate(${deg}deg)`;
  document.getElementById('percent').textContent = percent + '%';
  document.getElementById('status').textContent = percent>=100 ? 'Sport terminÃ© âœ…' : 'Sport non terminÃ© ðŸ”’';
}

/* Boutons TV */
function unlockTV(){ document.getElementById('status').textContent='TV dÃ©bloquÃ©e âœ…'; }
function lockTV(){ document.getElementById('status').textContent='Sport non terminÃ© ðŸ”’'; }

/* Initialisation */
window.onload = function(){
  const saved = JSON.parse(localStorage.getItem('dailyGoals')) || [];
  if(saved.length>0){
    saved.forEach(g=>addSport(g.sport,g.distance));
  } else addSport(); // un sport par dÃ©faut
  updateProgress();
};
</script>

</body>
</html>
